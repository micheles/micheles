<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.3.1: http://docutils.sourceforge.net/" />
<title>Parsing the command line</title>
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<div class="document" id="parsing-the-command-line">
<h1 class="title">Parsing the command line</h1>
<p>The module optparse was a great addition to Python 2.3, since it is much more 
powerful and easier to use than getopt. Using optparse, writing command-line
tools is a breeze. However, the power of optparse comes together with a certain
verbosity. This recipe allows to use optparse with a minimum of boilerplate, 
trading flexibility for easy of use. Still, it covers 95% of my common needs, 
so I think it may be useful to others.</p>
<p>The following script is an example of how to use the optionparse module.</p>
<p>&lt;pre&gt;</p>
<p>&quot;&quot;&quot;An example script invoking optionparse.</p>
<blockquote>
usage: %prog [options] args
-p, --positional: print positional arguments
-1, --option1=OPTION1: print option1
-2, --option2=OPTION2: print option2</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt>optparse.txt</tt>, line 21)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<p>&quot;&quot;&quot;</p>
<p>import optionparse
opt, args = optionparse.parse(__doc__)
if not opt and not args:</p>
<div class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<tt>optparse.txt</tt>, line 26)</p>
Unexpected indentation.</div>
<blockquote>
optionparse.exit()</blockquote>
<div class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<tt>optparse.txt</tt>, line 27)</p>
Block quote ends without a blank line; unexpected unindent.</div>
<dl>
<dt>if opt.positional:</dt>
<dd>print args</dd>
<dt>if opt.option1:</dt>
<dd>print opt.option1</dd>
<dt>if opt.option2:</dt>
<dd>print opt.option2</dd>
</dl>
<p>&lt;/pre&gt;</p>
<p>The optionparse.parse() function parses the docstring and internally builds
an option parser object using optparse; then it uses that parser to
parse the command line arguments. It returns an object containing
the given options and a list of positional arguments.</p>
<p>If no options and positional arguments are given, the script
exits and returns an useful message:</p>
<p>&lt;pre&gt;</p>
<p>$ python example.py
An example script invoking optionparse.</p>
<blockquote>
usage: example.py [options] args
-p, --positional: print positional arguments
-1, --option1=OPTION1: print option1
-2, --option2=OPTION2: print option2</blockquote>
<p>&lt;/pre&gt;</p>
<p>A similar message is also obtained if the -h or --help option is
passed.</p>
<p>If the -p flag is passed, the list of positional arguments is displayed:</p>
<p>&lt;pre&gt;</p>
<p>$ python example.py -p <a href="#id1" name="id2"><span class="problematic" id="id2">*</span></a>.txt
[&lt;the list of text files in the current directory&gt;]</p>
<div class="system-message" id="id1">
<p class="system-message-title">System Message: <a name="id1">WARNING/2</a> (<tt>optparse.txt</tt>, line 63); <em><a href="#id2">backlink</a></em></p>
Inline emphasis start-string without end-string.</div>
<p>&lt;/pre&gt;</p>
<p>If the option argument 1 or 2 are passed, they are displayed:</p>
<p>&lt;pre&gt;</p>
<p>$ python example.py -1file1.txt -2file2.txt
file1.txt
file2.txt</p>
<p>&lt;/pre&gt;</p>
<p>I think you get the idea. Notice that with the current implementation
there are restrictions with the format of the usage block in the 
docstring: for instance it cannot contain blank lines and one must
be careful with characters such as &quot;:&quot; &quot;,&quot; &quot;=&quot;.</p>
</div>
<hr class="footer" />
<div class="footer">
<a class="reference" href="optparse.txt">View document source</a>.
Generated on: 2004-04-18 07:16 UTC.
Generated by <a class="reference" href="http://docutils.sourceforge.net/">Docutils</a> from <a class="reference" href="http://docutils.sourceforge.net/rst.html">reStructuredText</a> source.
</div>
</body>
</html>
